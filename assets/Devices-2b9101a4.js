import{_ as ie,j as r,k as P,r as d,l as de,o as b,c as I,a as o,b as t,w as l,n as re,p as L,x as C,u as $,e as c,F as A,q as R,t as k,v as F,E as ce,y as pe,C as me,B as ve}from"./index-395d7d23.js";const fe={class:"devices"},_e={class:"header"},ye={class:"header-operations"},ge={class:"search-bar"},be={class:"card-amount"},ke={class:"card-amount success"},he={class:"card-amount warning"},Ce={class:"card-amount danger"},we={class:"pagination"},Ve={__name:"Devices",setup(xe){const w=r(""),V=r(""),x=r(""),z=r(1),N=r(10),f=r(!1),_=r(!1),p=r("add"),S=r(null),n=r({name:"",type:"",location:"",mac:"",ip:"",description:""}),j={name:[{required:!0,message:"请输入设备名称",trigger:"blur"}],type:[{required:!0,message:"请选择设备类型",trigger:"change"}],location:[{required:!0,message:"请输入安装位置",trigger:"blur"}],mac:[{required:!0,message:"请输入MAC地址",trigger:"blur"}],ip:[{required:!0,message:"请输入IP地址",trigger:"blur"}]},T=[{value:"camera",label:"监控摄像头"},{value:"sensor",label:"环境传感器"},{value:"bracelet",label:"智能手环"},{value:"mattress",label:"智能床垫"},{value:"monitor",label:"生命体征监测仪"},{value:"intercom",label:"对讲设备"},{value:"gateway",label:"网关设备"},{value:"alarm",label:"紧急呼叫器"},{value:"lock",label:"智能门锁"},{value:"light",label:"智能照明"}],u=r([{id:"1",name:"呼叫器-301",type:"caller",location:"301房间",status:"在线",lastCheck:"2025-02-26 10:00:00",battery:85,mac:"00:11:22:33:44:55",ip:"192.168.1.101",description:"床头呼叫器"},{id:"2",name:"摄像头-大厅",type:"camera",location:"一楼大厅",status:"在线",lastCheck:"2025-02-26 10:00:00",battery:100,mac:"00:11:22:33:44:56",ip:"192.168.1.102",description:"大厅监控摄像头"},{id:"3",name:"手环-张建国",type:"bracelet",location:"301房间",status:"在线",lastCheck:"2025-02-26 10:00:00",battery:45,mac:"00:11:22:33:44:57",ip:"192.168.1.103",description:"老人定位手环"},{id:"4",name:"床垫-302",type:"mattress",location:"302房间",status:"离线",lastCheck:"2025-02-26 09:00:00",battery:20,mac:"00:11:22:33:44:58",ip:"192.168.1.104",description:"智能监测床垫"},{id:"5",name:"监测仪-303",type:"monitor",location:"303房间",status:"故障",lastCheck:"2025-02-26 08:00:00",battery:0,mac:"00:11:22:33:44:59",ip:"192.168.1.105",description:"生命体征监测仪"},{id:"6",name:"摄像头-304",type:"camera",location:"304房间",status:"在线",lastCheck:"2025-02-26 11:30:00",battery:100,mac:"00:11:22:33:44:60",ip:"192.168.1.106",description:"高清监控摄像头"},{id:"7",name:"传感器-305",type:"sensor",location:"305房间",status:"在线",lastCheck:"2025-02-26 11:00:00",battery:85,mac:"00:11:22:33:44:61",ip:"192.168.1.107",description:"温湿度空气质量传感器"},{id:"8",name:"对讲机-306",type:"intercom",location:"306房间",status:"在线",lastCheck:"2025-02-26 10:30:00",battery:90,mac:"00:11:22:33:44:62",ip:"192.168.1.108",description:"双向语音对讲设备"},{id:"9",name:"网关-3楼",type:"gateway",location:"3楼走廊",status:"在线",lastCheck:"2025-02-26 10:00:00",battery:100,mac:"00:11:22:33:44:63",ip:"192.168.1.109",description:"物联网设备网关"},{id:"10",name:"呼叫器-307",type:"alarm",location:"307房间",status:"离线",lastCheck:"2025-02-26 09:30:00",battery:15,mac:"00:11:22:33:44:64",ip:"192.168.1.110",description:"紧急呼叫按钮"},{id:"11",name:"门锁-308",type:"lock",location:"308房间",status:"在线",lastCheck:"2025-02-26 09:00:00",battery:75,mac:"00:11:22:33:44:65",ip:"192.168.1.111",description:"智能门锁"},{id:"12",name:"照明-309",type:"light",location:"309房间",status:"在线",lastCheck:"2025-02-26 08:30:00",battery:100,mac:"00:11:22:33:44:66",ip:"192.168.1.112",description:"智能照明控制器"},{id:"13",name:"手环-310",type:"bracelet",location:"310房间",status:"故障",lastCheck:"2025-02-26 08:00:00",battery:0,mac:"00:11:22:33:44:67",ip:"192.168.1.113",description:"老人定位手环"},{id:"14",name:"床垫-311",type:"mattress",location:"311房间",status:"在线",lastCheck:"2025-02-26 07:30:00",battery:95,mac:"00:11:22:33:44:68",ip:"192.168.1.114",description:"智能监测床垫"},{id:"15",name:"监测仪-312",type:"monitor",location:"312房间",status:"在线",lastCheck:"2025-02-26 07:00:00",battery:88,mac:"00:11:22:33:44:69",ip:"192.168.1.115",description:"生命体征监测仪"}]),E=P(()=>{let s=u.value;if(w.value){const e=w.value.toLowerCase();s=s.filter(i=>i.name.toLowerCase().includes(e)||i.location.toLowerCase().includes(e))}return V.value&&(s=s.filter(e=>e.type===V.value)),x.value&&(s=s.filter(e=>e.status===x.value)),s}),Q=P(()=>E.value.length),G=s=>{const e=T.find(i=>i.value===s);return e?e.label:s},H=s=>{switch(s){case"在线":return"success";case"离线":return"warning";case"故障":return"danger";default:return"info"}},J=s=>s<=20?"exception":s<=50?"warning":"success",K=()=>{p.value="add",n.value={name:"",type:"",location:"",mac:"",ip:"",description:""},_.value=!0},O=s=>{p.value="edit",n.value={...s},_.value=!0},W=s=>{p.value="view",n.value={...s},_.value=!0},X=s=>{f.value=!0,setTimeout(()=>{C.success(`设备 ${s.name} 检查完成`);const e=u.value.findIndex(i=>i.id===s.id);e!==-1&&(u.value[e]={...s,lastCheck:new Date().toLocaleString(),status:"在线"}),f.value=!1},1500)},Y=s=>{ce.confirm(`确认重启设备 ${s.name}？`,"重启确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{f.value=!0,setTimeout(()=>{const e=u.value.findIndex(i=>i.id===s.id);e!==-1&&(u.value[e]={...s,status:"在线"}),C.success("设备重启成功"),f.value=!1},2e3)})},Z=()=>{f.value=!0,setTimeout(()=>{u.value=u.value.map(s=>({...s,lastCheck:new Date().toLocaleString(),status:s.status==="故障"?"故障":"在线"})),C.success("批量检查完成"),f.value=!1},2e3)},ee=async()=>{S.value&&await S.value.validate(s=>{if(s){if(p.value==="add"){const e=String(Math.max(...u.value.map(i=>Number(i.id)))+1);u.value.push({id:e,...n.value,status:"在线",lastCheck:new Date().toLocaleString(),battery:100}),C.success("添加成功")}else if(p.value==="edit"){const e=u.value.findIndex(i=>i.id===n.value.id);e!==-1&&(u.value[e]={...u.value[e],...n.value},C.success("修改成功"))}_.value=!1}})};return(s,e)=>{const i=d("el-icon"),m=d("el-button"),y=d("el-input"),h=d("el-option"),B=d("el-select"),U=d("el-card"),D=d("el-col"),te=d("el-row"),v=d("el-table-column"),M=d("el-tag"),ae=d("el-progress"),le=d("el-table"),se=d("el-pagination"),g=d("el-form-item"),ne=d("el-form"),oe=d("el-dialog"),ue=de("loading");return b(),I("div",fe,[o("div",_e,[e[15]||(e[15]=o("h2",null,"智能设备",-1)),o("div",ye,[t(m,{type:"primary",onClick:K},{default:l(()=>[t(i,null,{default:l(()=>[t($(pe))]),_:1}),e[13]||(e[13]=c("添加设备 "))]),_:1}),t(m,{type:"warning",onClick:Z},{default:l(()=>[t(i,null,{default:l(()=>[t($(me))]),_:1}),e[14]||(e[14]=c("批量检查 "))]),_:1})])]),o("div",ge,[t(y,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=a=>w.value=a),placeholder:"搜索设备...",style:{width:"200px"},clearable:""},{prefix:l(()=>[t(i,null,{default:l(()=>[t($(ve))]),_:1})]),_:1},8,["modelValue"]),t(B,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=a=>V.value=a),placeholder:"设备类型",clearable:"",style:{"margin-left":"10px",width:"150px"}},{default:l(()=>[(b(),I(A,null,R(T,a=>t(h,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),t(B,{modelValue:x.value,"onUpdate:modelValue":e[2]||(e[2]=a=>x.value=a),placeholder:"设备状态",clearable:"",style:{"margin-left":"10px",width:"120px"}},{default:l(()=>[t(h,{label:"在线",value:"在线"}),t(h,{label:"离线",value:"离线"}),t(h,{label:"故障",value:"故障"})]),_:1},8,["modelValue"])]),t(te,{gutter:20,class:"statistics-cards"},{default:l(()=>[t(D,{span:6},{default:l(()=>[t(U,{shadow:"hover"},{header:l(()=>e[16]||(e[16]=[o("div",{class:"card-header"},[o("span",null,"设备总数")],-1)])),default:l(()=>[o("div",be,k(u.value.length),1)]),_:1})]),_:1}),t(D,{span:6},{default:l(()=>[t(U,{shadow:"hover"},{header:l(()=>e[17]||(e[17]=[o("div",{class:"card-header"},[o("span",null,"在线设备")],-1)])),default:l(()=>[o("div",ke,k(u.value.filter(a=>a.status==="在线").length),1)]),_:1})]),_:1}),t(D,{span:6},{default:l(()=>[t(U,{shadow:"hover"},{header:l(()=>e[18]||(e[18]=[o("div",{class:"card-header"},[o("span",null,"离线设备")],-1)])),default:l(()=>[o("div",he,k(u.value.filter(a=>a.status==="离线").length),1)]),_:1})]),_:1}),t(D,{span:6},{default:l(()=>[t(U,{shadow:"hover"},{header:l(()=>e[19]||(e[19]=[o("div",{class:"card-header"},[o("span",null,"故障设备")],-1)])),default:l(()=>[o("div",Ce,k(u.value.filter(a=>a.status==="故障").length),1)]),_:1})]),_:1})]),_:1}),re((b(),L(le,{data:E.value,style:{width:"100%"}},{default:l(()=>[t(v,{type:"selection",width:"55"}),t(v,{prop:"name",label:"设备名称",width:"150"}),t(v,{prop:"type",label:"设备类型",width:"150"},{default:l(({row:a})=>[t(M,null,{default:l(()=>[c(k(G(a.type)),1)]),_:2},1024)]),_:1}),t(v,{prop:"location",label:"安装位置",width:"150"}),t(v,{prop:"status",label:"状态",width:"100"},{default:l(({row:a})=>[t(M,{type:H(a.status)},{default:l(()=>[c(k(a.status),1)]),_:2},1032,["type"])]),_:1}),t(v,{prop:"lastCheck",label:"最后检查",width:"180"}),t(v,{prop:"battery",label:"电量",width:"180"},{default:l(({row:a})=>[t(ae,{percentage:a.battery,status:J(a.battery)},null,8,["percentage","status"])]),_:1}),t(v,{label:"操作",width:"250",fixed:"right"},{default:l(({row:a})=>[t(m,{link:"",type:"primary",onClick:q=>O(a)},{default:l(()=>e[20]||(e[20]=[c("配置")])),_:2},1032,["onClick"]),t(m,{link:"",type:"primary",onClick:q=>W(a)},{default:l(()=>e[21]||(e[21]=[c("详情")])),_:2},1032,["onClick"]),t(m,{link:"",type:"success",onClick:q=>X(a)},{default:l(()=>e[22]||(e[22]=[c("检查")])),_:2},1032,["onClick"]),a.status==="离线"?(b(),L(m,{key:0,link:"",type:"warning",onClick:q=>Y(a)},{default:l(()=>e[23]||(e[23]=[c(" 重启 ")])),_:2},1032,["onClick"])):F("",!0)]),_:1})]),_:1},8,["data"])),[[ue,f.value]]),o("div",we,[t(se,{"current-page":z.value,"onUpdate:currentPage":e[3]||(e[3]=a=>z.value=a),"page-size":N.value,"onUpdate:pageSize":e[4]||(e[4]=a=>N.value=a),total:Q.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next"},null,8,["current-page","page-size","total"])]),t(oe,{title:p.value==="add"?"添加设备":p.value==="edit"?"设备配置":"设备详情",modelValue:_.value,"onUpdate:modelValue":e[12]||(e[12]=a=>_.value=a),width:"600px"},{footer:l(()=>[t(m,{onClick:e[11]||(e[11]=a=>_.value=!1)},{default:l(()=>e[24]||(e[24]=[c("取消")])),_:1}),p.value!=="view"?(b(),L(m,{key:0,type:"primary",onClick:ee},{default:l(()=>e[25]||(e[25]=[c(" 确定 ")])),_:1})):F("",!0)]),default:l(()=>[t(ne,{ref_key:"formRef",ref:S,model:n.value,rules:j,"label-width":"100px",disabled:p.value==="view"},{default:l(()=>[t(g,{label:"设备名称",prop:"name"},{default:l(()=>[t(y,{modelValue:n.value.name,"onUpdate:modelValue":e[5]||(e[5]=a=>n.value.name=a)},null,8,["modelValue"])]),_:1}),t(g,{label:"设备类型",prop:"type"},{default:l(()=>[t(B,{modelValue:n.value.type,"onUpdate:modelValue":e[6]||(e[6]=a=>n.value.type=a),placeholder:"请选择设备类型"},{default:l(()=>[(b(),I(A,null,R(T,a=>t(h,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1}),t(g,{label:"安装位置",prop:"location"},{default:l(()=>[t(y,{modelValue:n.value.location,"onUpdate:modelValue":e[7]||(e[7]=a=>n.value.location=a)},null,8,["modelValue"])]),_:1}),t(g,{label:"MAC地址",prop:"mac"},{default:l(()=>[t(y,{modelValue:n.value.mac,"onUpdate:modelValue":e[8]||(e[8]=a=>n.value.mac=a)},null,8,["modelValue"])]),_:1}),t(g,{label:"IP地址",prop:"ip"},{default:l(()=>[t(y,{modelValue:n.value.ip,"onUpdate:modelValue":e[9]||(e[9]=a=>n.value.ip=a)},null,8,["modelValue"])]),_:1}),t(g,{label:"备注",prop:"description"},{default:l(()=>[t(y,{modelValue:n.value.description,"onUpdate:modelValue":e[10]||(e[10]=a=>n.value.description=a),type:"textarea",rows:2},null,8,["modelValue"])]),_:1})]),_:1},8,["model","disabled"])]),_:1},8,["title","modelValue"])])}}},De=ie(Ve,[["__scopeId","data-v-86535479"]]);export{De as default};
